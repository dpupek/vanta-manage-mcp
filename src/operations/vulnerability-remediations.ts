// 1. Imports
import {
  CallToolResult,
  Tool,
  z,
  createPaginationSchema,
  makePaginatedGetRequest,
} from "./common/imports.js";

// 2. Input Schemas
const ListVulnerabilityRemediationsInput = createPaginationSchema();

// 3. Tool Definitions
export const ListVulnerabilityRemediationsTool: Tool<
  typeof ListVulnerabilityRemediationsInput
> = {
  name: "list_vulnerability_remediations",
  description:
    "List all vulnerability remediations in your Vanta account. Returns remediation IDs, vulnerability references, status, and progress for tracking security improvements. Use this to see all vulnerability remediation efforts and their current status.",
  parameters: ListVulnerabilityRemediationsInput,
};

// 4. Implementation Functions
export async function listVulnerabilityRemediations(
  args: z.infer<typeof ListVulnerabilityRemediationsInput>,
): Promise<CallToolResult> {
  return makePaginatedGetRequest("/v1/vulnerability-remediations", args);
}

// Registry export for automated tool registration
export default {
  tools: [
    {
      tool: ListVulnerabilityRemediationsTool,
      handler: listVulnerabilityRemediations,
    },
  ],
};
